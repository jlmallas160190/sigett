<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xml:lang="es" lang="es">

    <body>
        <ui:composition template="./principalDocente.xhtml">     
            <ui:define name="title">
                <h:outputText value="#{msg['lbl.seguimiento']} #{msg['lbl.proyecto']}" />
            </ui:define>
            <ui:define name="top">
                <f:view  locale="#{localizacion.locale}">
                    <h:form id="superior">
                        <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                            <!-- Indicators -->
                            <ol class="carousel-indicators">
                                <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
                                <li data-target="#carousel-example-generic" data-slide-to="1"></li>
                            </ol>

                            <!-- Wrapper for slides -->
                            <div class="carousel-inner">
                                <div class="item active">
                                    <div class="carousel-caption">
                                        <h3>SIGETT</h3>
                                    </div>
                                </div>
                                <div class="item">

                                    <div class="carousel-caption">
                                        <h3>SIGETT</h3>
                                    </div>
                                </div>

                            </div>

                            <!-- Controls -->
                            <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                                <span class="glyphicon glyphicon-chevron-left"></span>
                            </a>
                            <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                                <span class="glyphicon glyphicon-chevron-right"></span>
                            </a>
                        </div>

                        <p:menubar>
                            <p:menuitem icon="ui-icon-home" action="pretty:principalDocente" value="#{msg['lbl.inicio']}"/>
                            <p:menuitem icon="ui-icon-follow-project" value="#{msg['lbl.seguimiento']} #{msg['lbl.proyectos']}" action="pretty:directorProyectos"/>
                            <f:facet name="options">
                                <p:outputLabel value="#{msg['lbl.saludo']}: #{sessionDocenteUsuario.docenteUsuario.docenteId.persona.nombres} #{sessionDocenteUsuario.docenteUsuario.docenteId.persona.apellidos}"></p:outputLabel>
                                <p:outputLabel value="#{msg['lbl.rol']}: #{login.getRol(sessionDocenteUsuario.docenteUsuario.usuario)}"></p:outputLabel>
                                <p:commandButton value="#{msg['lbl.cambiar']} #{msg['lbl.clave']}"  action="cambiarClaveDocente?faces-redirect=true"/>
                                <p:commandButton value="#{msg['lbl.regresar']}" icon="ui-icon-arrowreturnthick-1-w" onclick="regresar()"/>
                                <p:commandButton value="#{msg['lbl.salir']}" ajax="false" icon="ui-icon-power" action="#{loginDocente.logout()}" />
                            </f:facet>
                        </p:menubar>
                    </h:form>
                </f:view>
            </ui:define>
            <ui:define  name="content">
                <p:messages id="msm" showDetail="true"/>
                <p:tabView id="datos" >
                    <p:ajax event="tabChange" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" 
                            update="tblProrrogas,fechaProrroga,avance,faltante,crearProrroga,crearInforme,tblInformes" listener="#{administrarProyectosDirector.onTabChange}"/>
                    <p:tab id="inicio" title="#{msg['lbl.informacion']}">
                        <p:panel header="#{msg['lbl.informacion']}" toggleable="true">
                            <h:panelGrid styleClass="panelgrid" rowClasses="rowpanelgrid" columnClasses="col-sm-2,col-sm-10" columns="2">
                                <h:outputLabel value="#{msg['lbl.tema']}:"/>
                                <h:outputText value="#{sessionProyectosDirector.directorProyecto.proyectoId.temaActual}"/>
                                <h:outputLabel value="#{msg['lbl.fecha']} #{msg['lbl.inicio']}:"/>
                                <h:outputText value="#{sessionProyectosDirector.directorProyecto.proyectoId.cronograma.fechaInicio}">
                                    <f:convertDateTime pattern="dd/MMMM/yyy"/>
                                </h:outputText>
                                <h:outputLabel value="#{msg['lbl.fechaCulminación']}:"/>
                                <h:outputText id="fechaProrroga" value="#{sessionProyectosDirector.directorProyecto.proyectoId.cronograma.fechaProrroga}">
                                    <f:convertDateTime pattern="dd/MMMM/yyy"/>
                                </h:outputText>
                                <h:outputLabel value="#{msg['lbl.estado']}:"/>
                                <h:outputText value="#{sessionProyectosDirector.directorProyecto.proyectoId.estadoProyectoId.nombre}"/>
                                <h:outputLabel value="#{msg['lbl.tipoProyecto']}:"/>
                                <h:panelGrid>
                                    <p:commandLink id="detalleTp" value="#{sessionProyectosDirector.directorProyecto.proyectoId.tipoProyectoId.nombre}"/>
                                    <p:overlayPanel  showEffect="blind" for="detalleTp"  hideEffect="fade">
                                        <h:panelGrid columns="2" styleClass="panelgrid" rowClasses="rowpanelgrid" columnClasses="col-sm-2,col-sm-10"  >
                                            <h:outputLabel value="#{msg['lbl.nombre']}:"/>
                                            <h:outputText value="#{sessionProyectosDirector.directorProyecto.proyectoId.tipoProyectoId.nombre}"/>
                                            <h:outputLabel value="#{msg['lbl.descripcion']}:"/>
                                            <h:outputText value="#{sessionProyectosDirector.directorProyecto.proyectoId.tipoProyectoId.descripcion}"/>
                                        </h:panelGrid>
                                    </p:overlayPanel>
                                </h:panelGrid>
                                <h:outputLabel value="#{msg['lbl.categoria']}:"/>
                                <h:panelGrid>
                                    <p:commandLink id="dc" value="#{sessionProyectosDirector.directorProyecto.proyectoId.catalogoProyectoId.nombre}"/>
                                    <p:overlayPanel styleClass="panelgrid" showEffect="blind" for="dc"  hideEffect="fade">
                                        <h:panelGrid columns="2" rowClasses="rowpanelgrid" columnClasses="col-sm-2,col-sm-10"  >
                                            <h:outputLabel value="#{msg['lbl.nombre']}:"/>
                                            <h:outputText value="#{sessionProyectosDirector.directorProyecto.proyectoId.catalogoProyectoId.nombre}"/>
                                            <h:outputLabel value="#{msg['lbl.descripcion']}:"/>
                                            <h:outputText value="#{sessionProyectosDirector.directorProyecto.proyectoId.catalogoProyectoId.descripcion}"/>
                                        </h:panelGrid>
                                    </p:overlayPanel>
                                </h:panelGrid>
                                <h:outputLabel value="#{msg['lbl.avance']}:"/>
                                <p:progressBar id="avance" styleClass="avance" labelTemplate="#{sessionProyectosDirector.directorProyecto.proyectoId.cronograma.avance}%" value="#{sessionProyectosDirector.directorProyecto.proyectoId.cronograma.avance}"/>
                                <h:outputLabel value="#{msg['lbl.faltante']}:"/>
                                <p:progressBar id="faltante" styleClass="faltante" labelTemplate="#{sessionProyectosDirector.directorProyecto.proyectoId.cronograma.faltante}%" value="#{sessionProyectosDirector.directorProyecto.proyectoId.cronograma.faltante}"/>
                            </h:panelGrid>
                        </p:panel>   
                        <br/>
                        <p:panel header="#{msg['lbl.documentos']}" toggleable="true">
                            <p:dataTable id="tblDocumentosProyecto" rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row'}" rowIndexVar="rowIx"  var="doc" rowKey="#{doc.catalogoDocumentoProyectoId.nombre}" selection="#{doc}" selectionMode="single" paginator="true" rows="8" value="#{sessionProyectosDirector.directorProyecto.proyectoId.documentoProyectoList}">
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.descargar']}"/>
                                    </f:facet> 
                                    <p:commandLink action="#{administrarDocumentosProyecto.downloadDocumento(doc)}" ajax="false">
                                        <p:graphicImage value="/resources/img/pdf.png"/>
                                    </p:commandLink> 
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.documento']}"/>
                                    </f:facet>
                                    <h:outputLabel value="#{doc.catalogoDocumentoProyectoId.nombre}"/>
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.size']}"/>
                                    </f:facet> 
                                    <h:outputLabel value="#{administrarDocumentosProyecto.obtenerSizeKB(doc)}"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                        <br/>
                        <p:panel toggleable="true" header="#{msg['lbl.lineasInvestigacion']}">
                            <p:dataGrid id="dgLineasInvestigacionProyecto" rowIndexVar="rowIx"  var="lp" paginatorPosition="bottom"
                                        paginator="true" rows="8" columns="1" value="#{sessionProyectosDirector.directorProyecto.proyectoId.lineaInvestigacionProyectoList}">
                                <p:panel toggleable="true" header="#{lp.lineaInvestigacionId.nombre}">
                                    <h:panelGrid columns="2" styleClass="panelgrid" columnClasses="cols-sm-3,col-sm-9" rowClasses="rowpanelgrid">
                                        <h:outputLabel value="#{msg['lbl.nombre']}"/>
                                        <h:outputText   value="#{lp.lineaInvestigacionId.nombre}"/>
                                        <h:outputLabel value="#{msg['lbl.descripcion']}"/>
                                        <h:outputText   value="#{lp.lineaInvestigacionId.descripcion}"/>
                                    </h:panelGrid>
                                </p:panel>
                            </p:dataGrid>
                        </p:panel>
                    </p:tab>
                    <p:tab id="prorrogas" title="#{msg['lbl.prorrogas']}">
                        <p:panel header="#{msg['lbl.buscar']} #{msg['lbl.por']} #{msg['lbl.criterio']}" toggleable="true">
                            <h:panelGrid styleClass="panelgrid" rowClasses="rowpanelgrid" columnClasses="col-sm-11,col-sm-1"  columns="2" >
                                <p:inputText style="text-transform: none" value="#{administrarProrrogas.criterio}"/>
                                <p:commandButton value="#{msg['lbl.buscar']}" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" icon="ui-icon-search" update="tblProrrogas,:contenido:msm" action="#{administrarProrrogas.buscar(sessionProyectosDirector.directorProyecto.proyectoId, sessionDocenteUsuario.docenteUsuario.usuario,administrarProrrogas.criterio)}"/>
                            </h:panelGrid>
                        </p:panel>
                        <br/>
                        <p:panel header="#{msg['lbl.listado']} #{msg['lbl.de']} #{msg['lbl.prorogas']}" toggleable="true">
                            <p:dataTable id="tblProrrogas" value="#{administrarProrrogas.prorrogas}" var="prorroga" rows="5" paginator="true"
                                         rowIndexVar="rowIx" rowKey="#{prorroga.fecha}" selectionMode="single" selection="#{prorroga}" editable="true" editMode="cell" rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row'}" emptyMessage="#{msg['lbl.table.empty']}">
                                <p:column sortBy="#{prorroga.fecha}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.fecha']} #{msg['lbl.de']} #{msg['lbl.prorroga']}"/>
                                    </f:facet>
                                    <h:outputText value="#{administrarConfiguraciones.date(prorroga.fecha)}"/>
                                </p:column>
                                <p:column sortBy="#{prorroga.motivo}" rendered="#{administrarProrrogas.renderedNoEditar}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.motivo']}"/>
                                    </f:facet>
                                    <h:outputText value="#{prorroga.motivo}"/>
                                </p:column>
                                <p:column sortBy="#{prorroga.motivo}" rendered="#{administrarProrrogas.renderedEditar}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.motivo']}"/>
                                    </f:facet>
                                    <p:commandLink  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="#{administrarProrrogas.editar(prorroga,sessionDocenteUsuario.docenteUsuario.usuario,sessionProyectosDirector.directorProyecto.proyectoId)}" update=":editarProrroga,:contenido:msm" value="#{prorroga.motivo}">
                                        <f:param name="1" value="editar-dlg"/>
                                    </p:commandLink>
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.aceptar']}"/>
                                    </f:facet>
                                    <h:outputText value="#{prorroga.esAceptado}"/>
                                </p:column>
                                <p:column rendered="#{administrarProrrogas.renderedEliminar}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.eliminar']}"/>
                                    </f:facet>
                                    <p:commandButton icon="ui-icon-trash"  onclick="if (!confirm('#{msg['lbl.confirmarEliminar']}'))
                                                return false;" update=":contenido:msm,tblProrrogas" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()"  action="#{administrarProrrogas.remover(prorroga, sessionProyecto.proyectoSeleccionado, sessionUsuario.usuario)}">

                                        <f:param name="2" value="remover-prorroga"/>
                                    </p:commandButton>
                                </p:column>
                                <p:column rendered="#{administrarProrrogas.renderedImprimirOficio}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.imprimir']} #{msg['lbl.oficio']}"/>
                                    </f:facet> 
                                    <p:commandButton onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" icon="ui-icon-print" update=":contenido:msm,:informeDirectorProrroga,:dlgInformeDirectorProrroga" action="#{administrarProrrogas.imprimirInformeOficioRespuesta(prorroga, sessionDocenteUsuario.docenteUsuario.usuario)}">
                                        <f:param name="1" value="informe"/>
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>
                            <f:facet name="footer">
                                <h:panelGrid id="crearProrroga" styleClass="pnl-botones">
                                    <p:commandButton update=":editarProrroga,:dlgEditarProrroga,:contenido:msm"  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" rendered="#{administrarProrrogas.renderedCrear}" value="#{msg['lbl.crear']}"  action="#{administrarProrrogas.crear(sessionDocenteUsuario.docenteUsuario.usuario,sessionProyectosDirector.directorProyecto.proyectoId)}" icon="ui-icon-newwin"/>
                                </h:panelGrid>
                            </f:facet>
                        </p:panel>      
                    </p:tab>
                    <p:tab id="actividades" title="#{msg['lbl.actividades']}">
                        <p:panel  header="#{msg['lbl.buscar']}" toggleable="true">
                            <h:panelGrid columns="2" styleClass="panelgrid" columnClasses="col-sm-10,col-sm-2" rowClasses="rowpanelgrid" >
                                <p:inputText style="text-transform: none" value="#{administrarActividades.criterioPorDirectorProyecto}"/>
                                <p:commandButton value="#{msg['lbl.buscar']}" icon="ui-icon-search"  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" update="treeActividades" action="#{administrarActividades.buscarPorDirector(administrarActividades.criterioPorDirectorProyecto,sessionDocenteUsuario.docenteUsuario.usuario, sessionProyectosDirector.directorProyecto.proyectoId)}"/>
                            </h:panelGrid>
                        </p:panel>
                        <br/>
                        <p:panel id="pnlActividades" toggleable="true" header="#{msg['lbl.actividades']}">
                            <p:tree id="treeActividades" value="#{administrarActividades.rootPorDirectorProyecto}" var="node" dynamic="true"  animate="true">
                                <p:treeNode collapsedIcon="ui-icon-folder-collapsed" expandedIcon="ui-icon-folder-open">
                                    <h:panelGrid styleClass="panel-group" columns="3">
                                        <h:outputLabel title="#{node.estadoActividadId.nombre}"  styleClass="#{administrarActividades.styleEstadoActividad(node)}"/>
                                        <p:commandLink  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" update=":editarActividad,:dlgActividad,:contenido:msm" action="#{administrarActividades.editar(node,sessionDocenteUsuario.docenteUsuario.usuario,sessionProyectosDirector.directorProyecto.proyectoId)}" value="#{node.nombre}">
                                            <f:param name="1" value="editar-dlg"/>
                                        </p:commandLink>
                                        <h:outputText rendered="#{administrarActividades.renderedNoEditarPorAutorProyecto}" value="#{node.nombre}"/>
                                        <p:progressBar  labelTemplate="#{node.avance}%" value="#{node.avance}"/>
                                    </h:panelGrid>
                                </p:treeNode>
                            </p:tree>
                        </p:panel>
                    </p:tab>
                    <p:tab id="autores" title="#{msg['lbl.autores']}">
                        <p:panel  header="#{msg['lbl.buscar']}" toggleable="true">
                            <h:panelGrid columns="1" styleClass="panelgrid" rowClasses="rowpanelgrid" >
                                <p:commandButton value="#{msg['lbl.buscar']}" icon="ui-icon-search"  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" update="dgAutores" action="#{autorProyectoPostulacionController.buscarAutoresDesdeDirectorProyecto('', sessionProyectosDirector.directorProyecto.proyectoId)}"/>
                            </h:panelGrid>
                        </p:panel>
                        <br/>
                        <p:panel header="#{msg['lbl.autores']}">
                            <p:dataGrid id="dgAutores"  rowIndexVar="rowIx"  var="autor"
                                        paginatorPosition="bottom" value="#{autorProyectoPostulacionController.autorProyectosDirectorProyecto}" paginator="true" rows="10">
                                <p:panel header="#{msg['lbl.datos']}" toggleable="true">
                                    <div class="row-fluid">
                                        <div class="col-sm-2">
                                            <p:graphicImage id="foto" cache="false"  styleClass="img-thumbnail" value="/AppServlet?id=#{autor.aspiranteId.estudianteCarrera.estudianteId.persona.id}&amp;entity=Persona"/>  
                                        </div>
                                        <div class="col-sm-10">
                                            <h:panelGrid columns="2" rowClasses="rowpanelgrid" styleClass="panelgrid" columnClasses="col-sm-4,col-sm-6"  >
                                                <h:outputLabel value="#{msg['lbl.nombres']}"/>
                                                <h:outputText value="#{autor.aspiranteId.estudianteCarrera.estudianteId.persona.nombres}"/>
                                                <h:outputLabel value="#{msg['lbl.apellidos']}"/>
                                                <h:outputText value="#{autor.aspiranteId.estudianteCarrera.estudianteId.persona.apellidos}"/>
                                                <h:outputLabel value="#{msg['lbl.fecha']} #{msg['lbl.inicio']}:"/>
                                                <h:outputText value="#{autor.fechaInicio}">
                                                    <f:convertDateTime pattern="EEEEE dd MMMMM yyyy"/>
                                                </h:outputText>
                                                <h:outputLabel value="#{msg['lbl.fechaCulminación']}:"/>
                                                <h:outputText value="#{autor.fechaCulminacion}">
                                                    <f:convertDateTime pattern="EEEEE dd MMMMM yyyy"/>
                                                </h:outputText>
                                                <h:outputLabel value="#{msg['lbl.estado']}"/>
                                                <h:outputText value="#{autor.aspiranteId.estudianteCarrera.estadoEstudianteCarrera.nombre}"/>
                                                <h:outputLabel value="#{msg['lbl.email']}"/>
                                                <h:outputText value="#{autor.aspiranteId.estudianteCarrera.estudianteId.persona.email}"/>
                                            </h:panelGrid>
                                        </div>
                                    </div>
                                </p:panel>
                            </p:dataGrid>
                        </p:panel>
                    </p:tab>
                    <p:tab id="informes" title="#{msg['lbl.certificaciones']}">
                        <p:panel header="#{msg['lbl.certificaciones']}">
                            <p:dataTable id="tblInformes" value="#{administrarInformesProyecto.informeProyectos}" var="informe" rows="5" paginator="true"
                                         rowIndexVar="rowIx" rowKey="#{informe.id}" selection="#{informe}" selectionMode="single" editable="true" editMode="cell" rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row'}" emptyMessage="#{msg['lbl.table.empty']}">
                                <p:column rendered="#{administrarInformesProyecto.renderedEditar}" sortBy="#{informe.id}">
                                    <f:facet name="header">
                                        <h:outputText value="Id"/>
                                    </f:facet>
                                    <p:commandLink  update=":editarInformeProyecto,:dlgInformeProyecto" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" value="#{informe.id}" action="#{administrarInformesProyecto.editar(sessionDocenteUsuario.docenteUsuario.usuario,informe,sessionProyectosDirector.directorProyecto.proyectoId)}">
                                        <f:param name="1" value="editar-dlg"/>
                                    </p:commandLink>
                                </p:column>
                                <p:column rendered="#{administrarInformesProyecto.renderedNoEditar}" sortBy="#{informe.id}">
                                    <f:facet name="header">
                                        <h:outputText value="Id"/>
                                    </f:facet>
                                    <h:outputText value="#{informe.id}"/>
                                </p:column>
                                <p:column sortBy="#{informe.fecha}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.fecha']}"/>
                                    </f:facet>
                                    <h:outputText value="#{administrarConfiguraciones.timestamp(informe.fecha)}"/>
                                </p:column>
                                <p:column rendered="#{administrarInformesProyecto.renderedEditar}" sortBy="#{informe.catalogoInformeProyectoId.nombre}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.categoria']}"/>
                                    </f:facet>
                                    <p:commandLink update=":editarInformeProyecto,:dlgInformeProyecto" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" value="#{informe.catalogoInformeProyectoId.nombre}" action="#{administrarInformesProyecto.editar(sessionDocenteUsuario.docenteUsuario.usuario,informe,sessionProyectosDirector.directorProyecto.proyectoId)}">
                                        <f:param name="1" value="editar-dlg"/>
                                    </p:commandLink>
                                </p:column>
                                <p:column rendered="#{administrarInformesProyecto.renderedNoEditar}" sortBy="#{informe.catalogoInformeProyectoId.nombre}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.categoria']}"/>
                                    </f:facet>
                                    <h:outputText value="#{informe.catalogoInformeProyectoId.nombre}"/>
                                </p:column>
                                <p:column >
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.imprimir']}"/>
                                    </f:facet>
                                    <p:commandButton onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" icon="ui-icon-print" update=":contenido:msm,:certificado,:dlgCertificacion" action="#{administrarInformesProyecto.imprimirCertificacion(sessionProyectosDirector.directorProyecto)}"/>
                                </p:column>
                                <p:column rendered="#{administrarInformesProyecto.renderedEliminar}">
                                    <f:facet name="header">
                                        <h:outputText value="#{msg['lbl.eliminar']}"/>
                                    </f:facet>
                                    <p:commandButton icon="ui-icon-trash"  onclick="if (!confirm('#{msg['lbl.confirmarEliminar']}'))
                                                return false;" update=":contenido:msm,tblInformes" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()"  action="#{administrarInformesProyecto.remover(informe, sessionDocenteUsuario.docenteUsuario.usuario,sessionProyectosDirector.directorProyecto.proyectoId)}">
                                        <f:param name="2" value="remover-prorroga"/>
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>
                            <f:facet name="footer">
                                <h:panelGrid id="crearInforme" styleClass="pnl-botones" >
                                    <p:commandButton update=":editarInformeProyecto,:dlgInformeProyecto,:contenido:msm"  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" rendered="#{administrarInformesProyecto.renderedCrear}" value="#{msg['lbl.crear']}" action="#{administrarInformesProyecto.crear(sessionDocenteUsuario.docenteUsuario.usuario,sessionProyectosDirector.directorProyecto.proyectoId)}" icon="ui-icon-newwin">
                                        <f:param name="1" value="crear-dlg"/>
                                    </p:commandButton>
                                </h:panelGrid>
                            </f:facet>
                        </p:panel>
                    </p:tab>
                </p:tabView>

            </ui:define>
            <ui:define name="dlgs">
                <p:dialog id="dlgActividad" header="#{msg['lbl.editar']} #{msg['lbl.actividad']}"  styleClass="modal-md"  widgetVar="dlgEditarActividad"  modal="true" 
                          showEffect="clip" hideEffect="fold" closeOnEscape="true" >
                    <h:form id="editarActividad">
                        <p:messages id="msm"/>
                        <p:panel rendered="#{administrarActividades.renderedDlgEditar}">
                            <p:tabView id="tabViewDatosActividad">
                                <p:ajax event="tabChange" onstart="PF('dlgLoading').show()" update="dgRevisiones" oncomplete="PF('dlgLoading').hide()"  listener="#{administrarActividades.onTabChange}"/>
                                <p:tab title="#{msg['lbl.informacion']} #{msg['lbl.inicio']}">
                                    <div class="row-fluid">
                                        <div class="col-sm-6">
                                            <p:media styleClass="img-thumbnail" value="/AppServlet?id=#{sessionActividad.actividad.id}&amp;entity=Actividad" player="pdf" width="100%" height="250"/>
                                        </div>
                                        <div class="col-sm-6">
                                            <h:panelGrid style="background: #f4f4f4" columns="2" styleClass="panelgrid" rowClasses="rowpanelgrid" columnClasses="col-sm-3,col-sm-8,col-lg-1">
                                                <h:outputLabel value="#{msg['lbl.tipo']}:"  />
                                                <h:outputText value="#{sessionActividad.actividad.tipoActividadId.nombre}"/>
                                                <h:outputLabel  value="#{msg['lbl.nombre']}:"  />
                                                <h:outputText value="#{sessionActividad.actividad.nombre}"/>
                                                <h:outputLabel  value="#{msg['lbl.duracion']}:"  />
                                                <h:outputText value="#{sessionActividad.actividad.duracion} #{msg['lbl.dias']}"/>
                                                <h:outputLabel  value="#{msg['lbl.equivalencia']}:"  />
                                                <h:outputText value="#{sessionActividad.actividad.porcentajeDuracion}%"/>   
                                            </h:panelGrid>  
                                        </div>
                                    </div>
                                </p:tab>
                                <p:tab id="tabRevisiones-director" title="#{msg['lbl.revisiones']}">
                                    <p:panel header="#{msg['lbl.revisiones']}">
                                        <p:dataGrid id="dgRevisiones" value="#{administrarRevisiones.revisions}" var="revision" rows="4" columns="1"  paginator="true"
                                                    rowIndexVar="rowIx" emptyMessage="#{msg['lbl.table.empty']}">
                                            <p:panel header="#{msg['lbl.revisado']}: #{administrarConfiguraciones.date(revision.fecha)} #{msg['lbl.desde']}: #{administrarConfiguraciones.time(revision.horaInicio)} #{msg['lbl.hasta']}: #{administrarConfiguraciones.time(revision.horaFin)}" toggleable="true">
                                                <h:panelGrid styleClass="panelgrid" rowClasses="rowpanelgrid" columnClasses="col-sm-2,col-sm-10" columns="2">
                                                    <h:outputLabel value="Observación:"/>
                                                    <h:outputText  value="#{revision.observacion}"/>
                                                    <h:outputLabel value="Sugerencia:"/>
                                                    <h:outputText id="sugerencia" value="#{revision.sugerencia}"/>
                                                </h:panelGrid>
                                            </p:panel>
                                        </p:dataGrid>
                                    </p:panel>
                                </p:tab>
                            </p:tabView>
                        </p:panel>
                    </h:form>
                </p:dialog>
                <p:dialog id="dlgInformeProyecto" widgetVar="dlgEditarInformeProyecto" header="#{msg['lbl.editar']} #{msg['lbl.informe']}"  styleClass="modal-md" modal="true" >
                    <h:form id="editarInformeProyecto">
                        <p:messages id="msm" showDetail="true"/>
                        <p:panel>
                            <h:panelGrid style="background: #f4f4f4" styleClass="panelgrid" rowClasses="rowpanelgrid" columnClasses="col-sm-2,col-sm-9,col-sm-1" columns="3">
                                <h:outputLabel value="#{msg['lbl.observacion']}:"/>
                                <p:inputTextarea id="observacion" style="text-transform: none" validatorMessage="#{msg['lbl.formato_invalido']}" value="#{sessionInformeProyecto.informeProyecto.observacion}" required="true" requiredMessage="#{msg['lbl.observacion']} #{msg['lbl.obligatorio']}">
                                    <p:ajax event="keyup" update="msmObservacion"/>
                                    <p:ajax event="change" update="@this,msm"/>
                                    <f:validateRegex pattern="^[A-Za-záéíóúñ]{1,}([\s][A-Za-záéíóúñ]{1,})*$" />
                                </p:inputTextarea>
                                <p:message id="msmObservacion" for="observacion"/>
                                <h:outputLabel value="#{msg['lbl.categoria']}"/>
                                <p:selectOneMenu value="#{administrarInformesProyecto.catalogoInformeProyecto}">
                                    <f:selectItems value="#{administrarCatalogoInformeProyecto.buscarActivos()}"/>
                                </p:selectOneMenu>
                            </h:panelGrid>
                            <f:facet name="footer">
                                <h:panelGrid columnClasses="col-sm-1,col-sm-11" columns="2">
                                    <p:commandButton value="#{msg['lbl.grabar']}"  icon="ui-icon-disk" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" update="@form,:contenido:datos:tblInformes,:contenido:datos:dgAutores" action="#{administrarInformesProyecto.grabar(sessionInformeProyecto.informeProyecto,sessionProyectosDirector.directorProyecto.proyectoId, sessionDocenteUsuario.docenteUsuario.usuario)}">
                                        <f:param value="grabar-dlg" name="1"/>
                                    </p:commandButton>
                                    <p:commandButton value="#{msg['lbl.grabar']} #{msg['lbl.editar']}" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" icon="ui-icon-disk" update="@form,:contenido:datos:tblInformes,:contenido:datos:dgAutores" action="#{administrarInformesProyecto.grabar(sessionInformeProyecto.informeProyecto,sessionProyectosDirector.directorProyecto.proyectoId, sessionDocenteUsuario.docenteUsuario.usuario)}">
                                        <f:param value="grabar-editar-dlg" name="1"/>
                                    </p:commandButton>
                                </h:panelGrid>
                            </f:facet>
                        </p:panel>
                    </h:form>
                </p:dialog>
                <p:dialog id="dlgEditarProrroga" header="#{msg['lbl.editar']} #{msg['lbl.prorroga']}"  styleClass="modal-sm" widgetVar="dlgEditarProrroga" modal="true" >
                    <h:form id="editarProrroga">
                        <p:panel rendered="#{administrarProrrogas.renderedDlgEditar}">
                            <p:messages id="msm"/>
                            <h:panelGrid columns="3" rowClasses="rowpanelgrid" styleClass="modal-body" columnClasses="col-sm-2,col-sm-9,col-sm-1">
                                <h:outputLabel value="#{msg['lbl.fecha']}:"/>
                                <p:calendar id="fecha" navigator="true" locale="es" pattern="dd/MM/yyyy" value="#{sessionProrroga.prorroga.fecha}" title="#{msg['lbl.fecha']}" required="true" requiredMessage="#{msg['lbl.fecha']} #{msg['lbl.obligatorio']}.">
                                    <p:ajax event="dateSelect" update="msmFecha"/>
                                    <p:ajax event="change" update="@this,msm"/>
                                </p:calendar>
                                <p:message id="msmFecha" display="icon" for="fecha"/>
                                <h:outputLabel  value="#{msg['lbl.motivo']}:" for="motivo" />
                                <p:inputTextarea disabled="true" id="motivo" value="#{sessionProrroga.prorroga.motivo}" title="#{msg['lbl.motivo']}" required="true" requiredMessage="#{msg['lbl.sugerencia']} #{msg['lbl.obligatorio']}">
                                    <p:ajax event="keyup" update="msmMotivo"/>
                                    <p:ajax event="change" update="@this,msm"/>
                                </p:inputTextarea>
                                <p:message id="msmMotivo" display="icon" for="motivo"/>
                                <h:outputLabel value="#{msg['lbl.aceptar']}:" for="aceptar" />
                                <p:selectBooleanCheckbox value="#{sessionProrroga.prorroga.esAceptado}"/>
                                <h:inputHidden/>
                                <h:outputLabel value="#{msg['lbl.observacion']}:" for="observacion" />
                                <p:inputTextarea id="observacion" value="#{sessionProrroga.prorroga.observacion}" title="#{msg['lbl.observacion']}" required="true" requiredMessage="#{msg['lbl.observacion']} #{msg['lbl.obligatorio']}.">
                                    <p:ajax event="keyup" update="msmObservacion"/>
                                    <p:ajax event="change" update="@this,msm"/>
                                </p:inputTextarea>
                                <p:message id="msmObservacion" display="icon" for="observacion"/>
                            </h:panelGrid>
                            <f:facet name="footer">
                                <h:panelGrid styleClass="pnl-botones" columns="1">
                                    <p:commandButton  value="#{msg['lbl.grabar']}" icon="ui-icon-disk" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" update="@form,:contenido:datos:tblProrrogas,msm,:contenido:msm" 
                                                      action="#{administrarProrrogas.grabar(sessionProrroga.prorroga, sessionProyectosDirector.directorProyecto.proyectoId, sessionDocenteUsuario.docenteUsuario.usuario)}">
                                        <f:param  name="1" value="grabar" />  
                                    </p:commandButton>
                                </h:panelGrid>
                            </f:facet>
                        </p:panel>
                    </h:form>
                </p:dialog>
                <p:dialog id="dlgCertificacion" widgetVar="dlgCertificacion" header="#{msg['lbl.certificado']}" styleClass="modal-md" modal="true" >
                    <h:form id="certificado" >
                        <p:panel rendered="#{administrarInformesProyecto.renderedDlgCertificado}">
                            <p:media value="/AppServlet?id=#{administrarInformesProyecto.dpId}&amp;entity=certificacion&amp;usuarioId=#{sessionDocenteUsuario.docenteUsuario.usuario.id}&amp;carreraId=#{administrarInformesProyecto.carreraId}&amp;lenguaje=#{administrarInformesProyecto.lenguaje}" player="pdf" width="100%" height="400"/>
                            <br/>
                            <h:panelGrid styleClass="pnl-botones" columns="2" columnClasses="col-sm-1">
                                <p:commandLink  title="#{msg['lbl.descargar']}" ajax="false" action="#{administrarInformesProyecto.download()}">
                                    <p:graphicImage height="25" width="25" value="/resources/img/icon_word.png"/>
                                </p:commandLink>
                            </h:panelGrid>
                        </p:panel>
                    </h:form>
                </p:dialog>
                <p:dialog id="dlgInformeDirectorProrroga" widgetVar="dlgInformeDirectorProrroga" header="#{msg['lbl.oficio']}" styleClass="modal-md" modal="true" >
                    <h:form id="informeDirectorProrroga" >
                        <p:panel rendered="#{administrarProrrogas.renderedDlgInforme}">
                            <p:media value="/AppServlet?id=#{administrarProrrogas.prorrogaId}&amp;entity=informeDirectorProrroga&amp;usuarioId=#{sessionDocenteUsuario.docenteUsuario.usuario.id}&amp;carreraId=#{administrarProrrogas.carreraId}" player="pdf" width="100%" height="400"/>
                            <br/>
                            <h:panelGrid styleClass="pnl-botones" columns="2" columnClasses="col-sm-1">
                                <p:commandLink  title="#{msg['lbl.descargar']}" ajax="false" action="#{administrarProrrogas.downloadInformeDocx(sessionDocenteUsuario.docenteUsuario.usuario)}">
                                    <p:graphicImage height="25" width="25" value="/resources/img/icon_word.png"/>
                                </p:commandLink>
                            </h:panelGrid>
                        </p:panel>
                    </h:form>
                </p:dialog>
            </ui:define>
        </ui:composition>
    </body>
</html>


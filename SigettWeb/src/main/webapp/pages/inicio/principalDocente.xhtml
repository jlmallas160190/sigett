<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <f:view >
        <h:head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
            <meta name="apple-mobile-web-app-capable" content="yes"/>
            <meta content="width=device-width, initial-scale=1"/>
            <h:outputStylesheet name="./css/default.css"/>
            <h:outputStylesheet name="./css/cssLayout.css"/>
            <h:outputStylesheet name="./css/bootstrap.css" />
            <h:outputScript name="./js/bootstrap.js"/>
            <h:outputScript name="./js/calendarEs.js"/>
            <h:outputScript name="./js/panel.js"/>
            <script>
                function regresar() {
                    window.history.back();
                }
            </script>
            <ui:insert name="favicon"><link rel="shortcut icon" type="image/x-icon" href="#{resource['img/favicon.ico']}"/></ui:insert> 
            <f:view >
                <h:form id="tittle">
                    <title>
                        <ui:insert name="title">
                            <h:outputText value="#{msg['lbl.principal']}"/>
                        </ui:insert>
                    </title>
                </h:form>
            </f:view>
        </h:head>
        <h:body>
            <div id="top">
                <ui:insert name="top">
                    <f:view  >
                        <h:form id="superior">
                            <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                                <!-- Indicators -->
                                <ol class="carousel-indicators">
                                    <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
                                    <li data-target="#carousel-example-generic" data-slide-to="1"></li>
                                </ol>

                                <!-- Wrapper for slides -->
                                <div class="carousel-inner">
                                    <div class="item active">
                                        <div class="carousel-caption">
                                            <h3>SIGETT</h3>
                                        </div>
                                    </div>
                                    <div class="item">

                                        <div class="carousel-caption">
                                            <h3>SIGETT</h3>
                                        </div>
                                    </div>

                                </div>

                                <!-- Controls -->
                                <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                                    <span class="glyphicon glyphicon-chevron-left"></span>
                                </a>
                                <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                                    <span class="glyphicon glyphicon-chevron-right"></span>
                                </a>
                            </div>
                            <p:menubar>
                                <f:facet name="options">
                                    <p:outputLabel value="#{msg['lbl.saludo']}: #{sessionDocenteUsuario.docenteUsuario.docenteId.persona.nombres} #{sessionDocenteUsuario.docenteUsuario.docenteId.persona.apellidos}"></p:outputLabel>
                                    <p:outputLabel value="#{msg['lbl.rol']}: #{login.getRol(sessionDocenteUsuario.docenteUsuario.usuario)}"></p:outputLabel>
                                   <!--  <p:commandButton value="#{msg['lbl.cambiar']} #{msg['lbl.clave']}" icon="ui-icon-key" action="{administrarUsuarios.abrirCambiarClaveDocente()}"/>-->
                                    <p:commandButton value="#{msg['lbl.regresar']}" icon="ui-icon-arrowreturnthick-1-w" onclick="regresar()"/>
                                    <p:commandButton value="#{msg['lbl.salir']}" ajax="false" icon="ui-icon-power" action="#{loginDocente.logout()}" />
                                </f:facet>
                            </p:menubar>
                        </h:form>
                    </f:view>
                </ui:insert>
                <ui:insert name="search">
                    <f:view>
                        <h:form id="formBuscar">
                            
                        </h:form>
                    </f:view>
                </ui:insert>

            </div>
            <div  class="container-fluid">
                <div class="row">
                    <div class="col-md-2">
                        <f:view >
                            <h:form id="izquierda">
                                <ui:insert name="left">
                                    <p:panel header="#{msg['lbl.menu']} #{msg['lbl.principal']}">
                                        <h:panelGrid styleClass="panelgrid" columns="3" rowClasses="rowpanelgrid" columnClasses="col-sm-1,col-sm-10,col-sm-1">
                                            <p:graphicImage width="16" height="16" value="/resources/blacks/16x16/120.png"/>
                                            <p:commandLink onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="pretty:principalDocente"  value="#{msg['lbl.inicio']}"/>
                                            <h:inputHidden/>
                                            <p:graphicImage width="16" height="16" value="/resources/png/32px/Shape2.png"/>
                                            <p:commandLink onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="pretty:docenteProyectos"  value="#{msg['lbl.pertinencias']} #{msg['lbl.proyectos']}"/>
                                            <span class="badge">#{administrarDocentesProyecto.docentesProyectosParaPertinencia.size()}</span>
                                            <p:graphicImage width="16" height="16" value="/resources/png/32px/Shape86.png"/>
                                            <p:commandLink  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="#{administrarProyectosDirector.viewBuscarDirectoresProyecto(sessionDocenteUsuario.docenteUsuario.usuario)}"  value="#{msg['lbl.seguimientos']} #{msg['lbl.proyectos']}"/>
                                            <span class="badge">#{administrarProyectosDirector.directorProyectos.size()}</span>
                                            <p:graphicImage width="16" height="16" value="/resources/png/32px/Shape149.png"/>
                                            <p:commandLink  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="#{administrarTribunales.viewBuscarTribunalesDocente(sessionDocenteUsuario.docenteUsuario.docenteId)}"  value="#{msg['lbl.tribunales']}"/>
                                            <span class="badge">#{administrarTribunales.tribunalesPorDocente.size()}</span>
                                            <p:graphicImage width="16" height="16" value="/resources/png/32px/Shape102.png"/>
                                            <p:commandLink  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="#{administrarLineasInvestigacionDocente.buscar(sessionDocenteUsuario.docenteUsuario.docenteId)}" value="#{msg['lbl.lineasInvestigacion']}"/>
                                        </h:panelGrid>
                                    </p:panel>
                                </ui:insert>
                            </h:form>
                        </f:view>
                    </div>
                    <div class="col-md-8">
                        <f:view  >
                            <h:form id="contenido">
                                <ui:insert name="content">
                                    <p:poll interval="#{administrarConfiguraciones.intervaloActualizaciones()}" listener="#{administrarActividades.notificacionActividadesPorRevisar(sessionDocenteUsuario.docenteUsuario.docenteId)}" update="schedule" />
                                    <p:schedule id="schedule" value="#{administrarActividades.eventModelDirector}" timeZone="GMT-5" view="agendaWeek">
                                        <p:ajax event="eventSelect" listener="#{administrarActividades.onEventSelect}" update=":dlgRevisarActividad,:revisarActividad" />                                      
                                        <p:ajax event="eventMove" listener="#{administrarActividades.onEventMove}"/>                                                                                  
                                        <p:ajax event="eventResize" listener="#{administrarActividades.onEventResize}"/>
                                    </p:schedule>
                                </ui:insert>
                            </h:form>
                        </f:view>
                        <f:view  >
                            <h:form id="form-data" enctype="multipart/form-data">
                                <ui:insert name="data">
                                </ui:insert>
                            </h:form>
                        </f:view>
                        <f:view  >
                            <ui:insert name="dlgs">
                                <p:dialog id="dlgRevisarActividad" widgetVar="dlgRevisarActividad" header="#{msg['lbl.actividad']}"  styleClass="modal-md" modal="true" >
                                    <h:form id="revisarActividad">
                                        <p:messages id="msm"/>
                                        <p:panel rendered="#{administrarActividades.renderedDlgRevisar}" header="#{sessionActividad.actividad.nombre}" toggleable="true">
                                            <f:facet name="options">
                                                <p:menu style="width:20%!important;height:auto!important">
                                                    <p:submenu style="border: 1px transparent !important;background: #fff !important;color: #666!important" label="#{msg['lbl.descargar']}">
                                                        <p:menuitem ajax="false" value="#{msg['lbl.descargar']} pdf" icon="ui-icon-pdf" action="#{administrarActividades.download('pdf',sessionActividad.actividad)}" />
                                                        <p:menuitem  ajax="false" value="#{msg['lbl.descargar']} docx" icon="ui-icon-odt" action="#{administrarActividades.download('docx',sessionActividad.actividad)}" />
                                                    </p:submenu>
                                                </p:menu>
                                            </f:facet>
                                            <h:panelGrid columns="1" styleClass="panelgrid">
                                                <p:media styleClass="img-thumbnail"  value="/AppServlet?id=#{sessionActividad.actividad.id}&amp;entity=Actividad" player="pdf" width="100%" height="300"/>
                                            </h:panelGrid>
                                            <br></br>
                                            <h:panelGrid id="opciones" columns="3" styleClass="pnl-botones" rendered="#{administrarRevisiones.renderedSubirDocActividad(sessionActividad.actividad)}">
                                                <p:commandButton value="#{msg['lbl.subir']}" update=":editarDocumentoActividad" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="#{administrarDocumentosActividad.editar(administrarDocumentosActividad.getDocumento(sessionActividad.actividad) ,sessionDocenteUsuario.docenteUsuario.usuario,sessionActividad.actividad,sessionActividad.actividad.cronogramaId.proyecto)}" icon="ui-icon-upload"/>
                                                <p:commandButton update=":editarRevision,:dlgEditarRevision" value="#{msg['lbl.revisar']}" icon="ui-icon-review" title="#{msg['lbl.revisar']}"  onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" rendered="#{administrarRevisiones.renderedCrear}"  action="#{administrarRevisiones.crear(sessionActividad.actividad,sessionDocenteUsuario.docenteUsuario.usuario)}">
                                                    <f:param name="1" value="crear-dlg"/>
                                                </p:commandButton>
                                            </h:panelGrid>
                                        </p:panel> 
                                        <p:panel header="#{msg['lbl.informacion']}" toggleable="true">
                                            <h:panelGrid style="background: #f4f4f4" rowClasses="rowpanelgrid" columns="2">
                                                <h:outputLabel value="#{msg['lbl.proyecto']}:"/>
                                                <h:outputText value="#{sessionActividad.actividad.cronogramaId.proyecto.temaActual}"/>
                                                <h:outputLabel value="#{msg['lbl.descripcion']}:"/>
                                                <h:outputText value="#{sessionActividad.actividad.observacion}"/>
                                                <h:outputLabel value="#{msg['lbl.lugar']}:"/>
                                                <p:inputText style="text-transform: none" value="#{sessionActividad.actividad.lugarRevision}"/>
                                            </h:panelGrid>
                                            <f:facet name="footer">
                                                <h:panelGrid styleClass="pnl-botones" columns="1">
                                                    <p:commandButton icon="ui-icon-disk" value="#{msg['lbl.grabar']}" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" update="msm" action="#{administrarActividades.grabar(sessionActividad.actividad, sessionActividad.actividad.cronogramaId, sessionDocenteUsuario.docenteUsuario.usuario)}">
                                                        <f:param name="1" value="grabar-editar-dlg"/>
                                                        <f:param name="2" value="docente"/>
                                                    </p:commandButton>
                                                </h:panelGrid>
                                            </f:facet>
                                        </p:panel>
                                    </h:form>
                                </p:dialog>
                                <p:dialog id="dlgEditarRevision" widgetVar="dlgEditarRevision" header="#{msg['lbl.editar']} #{msg['lbl.revision']}"  styleClass="modal-sm"  modal="true" >
                                    <h:form id="editarRevision">
                                        <p:panel rendered="#{administrarActividades.renderedDlgRevisar}">
                                            <p:messages id="msm" showDetail="true"/>
                                            <h:panelGrid style="background: #f4f4f4" styleClass="modal-body" rowClasses="rowpanelgrid" columnClasses="col-sm-2,col-sm-9,col-sm-1"  columns="3">
                                                <h:outputLabel value="#{msg['lbl.observacion']}:"/>
                                                <p:inputTextarea id="observacion" style="text-transform: none" value="#{sessionRevision.revision.observacion}" required="true" requiredMessage="#{msg['lbl.observacion']} #{msg['lbl.obligatorio']}"/>
                                                <p:message id="msmObservacion" display="icon" for="observacion"/>
                                                <h:outputLabel value="#{msg['lbl.sugerencia']}:"/>
                                                <p:inputTextarea id="sugerencia" style="text-transform: none" value="#{sessionRevision.revision.sugerencia}" required="true" requiredMessage="#{msg['lbl.sugerencia']} #{msg['lbl.obligatorio']}"/>
                                                <p:message id="msmSugerencia" display="icon" for="sugerencia"/>
                                            </h:panelGrid>
                                            <f:facet name="footer">
                                                <h:panelGrid  columns="2" columnClasses="col-sm-1,col-sm-11">
                                                    <p:commandButton value="#{msg['lbl.grabar']}" icon="ui-icon-disk" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" onclick="if (!confirm('¿#{msg['lbl.confirmar_grabar']}?'))
                                                                return false;" update="@form,:contenido:schedule" action="#{administrarRevisiones.grabar(sessionRevision.revision, sessionActividad.actividad,sessionActividad.actividad.cronogramaId.proyecto,sessionDocenteUsuario.docenteUsuario.docenteId,sessionDocenteUsuario.docenteUsuario.usuario)}">
                                                        <f:param value="grabar-dlg" name="1"/>
                                                    </p:commandButton>
                                                    <p:commandButton value="#{msg['lbl.grabar']} #{msg['lbl.editar']}" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" onclick="if (!confirm('¿#{msg['lbl.confirmar_grabar']}?'))
                                                                return false;" icon="ui-icon-disk" update="@form,:contenido:schedule" action="#{administrarRevisiones.grabar(sessionRevision.revision, sessionActividad.actividad,sessionActividad.actividad.cronogramaId.proyecto,sessionDocenteUsuario.docenteUsuario.docenteId,sessionDocenteUsuario.docenteUsuario.usuario)}">
                                                        <f:param value="grabar-editar-dlg" name="1"/>
                                                    </p:commandButton>
                                                </h:panelGrid>
                                            </f:facet>
                                        </p:panel>
                                    </h:form>
                                </p:dialog>
                                <p:dialog  header="#{msg['lbl.subir']}" widgetVar="dlgEditarDocumentoActividad" modal="true" styleClass="modal-sm"  >
                                    <h:form id="editarDocumentoActividad">  
                                        <h:panelGrid styleClass="panelgrid">
                                            <p:fileUpload multiple="false" fileUploadListener="#{administrarDocumentosActividad.handleFileUpload}" 
                                                          mode="advanced"  
                                                          allowTypes="/(\.|\/)(pdf)$/" sizeLimit="#{administrarConfiguraciones.tamanioPermitidoArchivos}" invalidFileMessage="#{msg['lbl.invalidTypeFileMessage']}"
                                                          cancelLabel="#{msg['lbl.cancelar']}"  invalidSizeMessage="#{msg['lbl.fileLimitMessage']}"  label="#{msg['lbl.seleccionar']}" uploadLabel="#{msg['lbl.subir']}">
                                                <f:attribute name="1" value="director" />
                                            </p:fileUpload>
                                        </h:panelGrid>
                                    </h:form>
                                </p:dialog>
                            </ui:insert>
                        </f:view>
                        <p:dialog id="dlgLoading" styleClass="load"  draggable="false" closable="false" resizable="false"  showHeader="false"  widgetVar="dlgLoading" modal="true" >
                            <h:panelGrid columns="2" >
                                <h:outputLabel value="#{msg['lbl.cargando']}"/>
                                <h:graphicImage   height="50" width="50" value="/resources/img/ajax-loader-green.gif" />
                            </h:panelGrid>
                        </p:dialog>
                    </div>
                    <div class="col-md-2">
                        <f:view >
                            <h:form id="derecha">
                                <ui:insert name="right">
                                    <p:panel header="#{msg['lbl.pertinencias']} #{msg['lbl.proyectos']}" toggleable="true">
                                        <p:poll interval="#{administrarConfiguraciones.intervaloActualizaciones()}" listener="#{administrarDocentesProyecto.docenteProyectosParaPertinencia(sessionDocenteUsuario.docenteUsuario.docenteId)}" update="dgProyectoParaPertinencia,:izquierda" />
                                        <p:dataGrid id="dgProyectoParaPertinencia" value="#{administrarDocentesProyecto.docentesProyectosParaPertinencia}" var="dp" 
                                                    rowIndexVar="rowIx"  paginatorPosition="bottom" paginator="true" columns="1" rows="5">
                                            <h:panelGrid style="background: #fff" styleClass="panelgrid" columns="1" >
                                                <p:outputLabel style="text-align:left;width: 100%" value="#{administrarConfiguraciones.timestamp(dp.fecha)}"/>
                                                <br/> 
                                                <p:commandLink value="#{dp.proyectoId.temaActual}" onstart="PF('dlgLoading').show()" oncomplete="PF('dlgLoading').hide()" action="#{administrarDocentesProyecto.editar(dp, sessionDocenteUsuario.docenteUsuario.usuario)}">
                                                    <f:param name="1" value="editar"/>
                                                </p:commandLink>
                                                <br/>
                                                <p:outputLabel style="color: #333" value="#{viewProyectos.autores(dp.proyectoId)}"/>
                                            </h:panelGrid>
                                        </p:dataGrid>
                                    </p:panel>
                                </ui:insert>
                            </h:form>
                        </f:view>
                    </div>

                </div>
            </div>
            <f:view >
                <h:form id="inferior">
                    <nav class="navbar navbar-inverse navbar-bottom" style="padding:0 0 100px 0;margin-top:50px">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-4">
                                    <br/>
                                    <p:panel header="#{msg['lbl.enlaces']}">
                                        <h:panelGrid columns="1" styleClass="panelgrid" rowClasses="rowpanelgrid">
                                            <h:commandLink styleClass="ui-commandlink"  target="_blank" value="#{msg['lbl.acceso']} #{msg['lbl.usuario']}" action="pretty:login"/>
                                            <h:commandLink styleClass="ui-commandlink" target="_blank" value="#{msg['lbl.acceso']} #{msg['lbl.estudiante']}" action="pretty:loginEstudiante"/>
                                        </h:panelGrid>
                                    </p:panel>
                                </div>
                                <div class="col-md-4">
                                    <br/>
                                    <p:panel header="#{msg['lbl.informacion']}">
                                        <center>
                                            <span ><b> Universidad Nacional de Loja </b></span><br/>
                                            <span>Carrera de Ingenieria en Sistemas</span> <br/>
                                            <span>Loja - Ecuador</span>
                                        </center>
                                    </p:panel>
                                </div>
                                <div class="col-md-4">
                                    <br/>
                                    <p:panel header="#{msg['lbl.lenguajes']}">
                                        <h:panelGrid styleClass="panelGroup" columns="2">
                                            <p:commandLink update=":tittle,:contenido,:superior,:derecha,:inferior,:izquierda,:dlgLoading"  title="Spanish"  action="#{localizacion.localeChanged()}">
                                                <f:param value="es" name="locale"/>
                                                <p:graphicImage width="20" height="20" value="/resources/img/icon_spain.jpg"/>
                                            </p:commandLink>
                                            <p:commandLink title="English" update=":tittle,:contenido,:superior,:derecha,:inferior,:izquierda,:dlgLoading"  action="#{localizacion.localeChanged()}">
                                                <f:param value="en" name="locale"/>
                                                <p:graphicImage width="20" height="20" value="/resources/img/icon_british.png"/>
                                            </p:commandLink>
                                        </h:panelGrid>
                                    </p:panel>
                                </div>
                            </div>
                        </div>
                    </nav>
                </h:form>
            </f:view>
        </h:body>
    </f:view>
</html>
